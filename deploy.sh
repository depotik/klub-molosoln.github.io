#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–µ–ø–ª–æ—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è "–ö–ª—É–± –º–æ–ª–æ—Å–æ–ª—å–Ω—ã—Ö –æ–≥—É—Ä—á–∏–∫–æ–≤ü•í"

echo "ü•í –î–µ–ø–ª–æ–π –ö–ª—É–±–∞ –º–æ–ª–æ—Å–æ–ª—å–Ω—ã—Ö –æ–≥—É—Ä—á–∏–∫–æ–≤..."
echo "===================================="

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è git
if ! command -v git &> /dev/null; then
    echo "‚ùå Git –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ git."
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è node –∏ npm
if ! command -v node &> /dev/null; then
    echo "‚ùå Node.js –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js."
    exit 1
fi

if ! command -v npm &> /dev/null; then
    echo "‚ùå npm –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ npm."
    exit 1
fi

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π..."
npm install

# –°–æ–∑–¥–∞–Ω–∏–µ –±–∏–ª–¥–∞
echo "üî® –°–æ–∑–¥–∞–Ω–∏–µ –±–∏–ª–¥–∞..."
npm run build

if [ $? -ne 0 ]; then
    echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –±–∏–ª–¥–∞"
    exit 1
fi

echo "‚úÖ –ë–∏–ª–¥ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Vercel CLI
if command -v vercel &> /dev/null; then
    echo "üöÄ –ù–∞–π–¥–µ–Ω Vercel CLI, –ø—Ä–æ–±—É–µ–º –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å..."
    
    # –ü–æ–ø—ã—Ç–∫–∞ –¥–µ–ø–ª–æ—è
    vercel --prod --yes
    
    if [ $? -eq 0 ]; then
        echo "‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–¥–µ–ø–ª–æ–µ–Ω–æ –Ω–∞ Vercel!"
        echo "üåê –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à—É —Å—Å—ã–ª–∫—É –≤ –∫–æ–Ω—Å–æ–ª–∏ –≤—ã—à–µ"
    else
        echo "‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å —á–µ—Ä–µ–∑ Vercel CLI"
        echo "üí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é: https://vercel.com"
    fi
else
    echo "‚ö†Ô∏è Vercel CLI –Ω–µ –Ω–∞–π–¥–µ–Ω"
    echo "üí° –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Vercel CLI: npm i -g vercel"
    echo "üí° –ò–ª–∏ –∑–∞–¥–µ–ø–ª–æ–π—Ç–µ –≤—Ä—É—á–Ω—É—é: https://vercel.com"
fi

echo ""
echo "üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:"
echo "1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–¥ –Ω–∞ GitHub"
echo "2. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://vercel.com"
echo "3. –ù–∞–∂–º–∏—Ç–µ 'New Project'"
echo "4. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π"
echo "5. –ù–∞–∂–º–∏—Ç–µ 'Deploy'"
echo ""
echo "üîë –ê–¥–º–∏–Ω-–ø–∞—Ä–æ–ª—å: cucumber"
echo "üéÆ –£–¥–∞—á–∏ –≤ –∏–≥—Ä–µ!"